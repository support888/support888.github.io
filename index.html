<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é©¬å…‹æ€ä¹ é¢˜</title>
    <style>
        /* ä¿æŒåŸæœ‰çš„CSSæ ·å¼ä¸å˜ */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(90deg, #2c3e50, #4a6491);
            color: white;
            padding: 25px;
            text-align: center;
        }
        
        h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 16px;
            opacity: 0.9;
        }
        
        .stats {
            display: flex;
            justify-content: space-around;
            background-color: #f8f9fa;
            padding: 15px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-label {
            font-size: 14px;
            color: #666;
        }
        
        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #2c3e50;
        }
        
        .question-container {
            padding: 30px;
            min-height: 300px;
        }
        
        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #eee;
        }
        
        .question-number {
            font-size: 20px;
            color: #2c3e50;
            font-weight: bold;
        }
        
        .question-type {
            background-color: #4a6491;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 14px;
        }
        
        .question-text {
            font-size: 18px;
            line-height: 1.6;
            margin-bottom: 30px;
            color: #333;
        }
        
        .options-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .option {
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 16px;
            display: flex;
            align-items: center;
        }
        
        .option:hover {
            background-color: #f0f5ff;
            border-color: #a0b8e0;
        }
        
        .option.selected {
            background-color: #e3f2fd;
            border-color: #2196f3;
        }
        
        .option.correct {
            background-color: #e8f5e9;
            border-color: #4caf50;
        }
        
        .option.wrong {
            background-color: #ffebee;
            border-color: #f44336;
        }
        
        .option-letter {
            display: inline-block;
            width: 30px;
            height: 30px;
            line-height: 30px;
            text-align: center;
            background-color: #e0e0e0;
            border-radius: 50%;
            margin-right: 15px;
            font-weight: bold;
        }
        
        .selected .option-letter {
            background-color: #2196f3;
            color: white;
        }
        
        .correct .option-letter {
            background-color: #4caf50;
            color: white;
        }
        
        .wrong .option-letter {
            background-color: #f44336;
            color: white;
        }
        
        .controls {
            display: flex;
            justify-content: space-between;
            padding: 20px 30px;
            background-color: #f8f9fa;
            border-top: 1px solid #eaeaea;
        }
        
        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .btn-prev {
            background-color: #f0f0f0;
            color: #333;
        }
        
        .btn-prev:hover {
            background-color: #e0e0e0;
        }
        
        .btn-next {
            background-color: #4a6491;
            color: white;
        }
        
        .btn-next:hover {
            background-color: #3a5479;
        }
        
        .btn-submit {
            background-color: #2c3e50;
            color: white;
        }
        
        .btn-submit:hover {
            background-color: #1a2530;
        }
        
        .result-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 100;
            display: none;
        }
        
        .result-content {
            background-color: white;
            padding: 30px;
            border-radius: 15px;
            max-width: 500px;
            width: 90%;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }
        
        .result-title {
            font-size: 24px;
            margin-bottom: 15px;
            color: #2c3e50;
        }
        
        .result-message {
            font-size: 18px;
            margin-bottom: 20px;
            line-height: 1.5;
        }
        
        .correct-answer {
            background-color: #e8f5e9;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            font-size: 16px;
            border-left: 5px solid #4caf50;
        }
        
        .btn-close {
            background-color: #4a6491;
            color: white;
            margin-top: 15px;
        }
        
        .chapter-filter {
            padding: 15px 30px;
            background-color: #f0f5ff;
            border-bottom: 1px solid #d0d9e8;
        }
        
        .filter-label {
            margin-right: 10px;
            font-weight: bold;
            color: #444;
        }
        
        .filter-select {
            padding: 8px 15px;
            border-radius: 6px;
            border: 1px solid #ccc;
            font-size: 14px;
            background-color: white;
            min-width: 200px;
        }
        
        .progress-bar {
            height: 6px;
            background-color: #eee;
            margin: 0 30px;
            border-radius: 3px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4a6491, #2c3e50);
            width: 0%;
            transition: width 0.5s;
        }
        
        .no-questions {
            text-align: center;
            padding: 40px;
            color: #666;
            font-size: 18px;
        }
        
        @media (max-width: 768px) {
            .container {
                border-radius: 10px;
            }
            
            .question-container {
                padding: 20px;
            }
            
            .controls {
                flex-direction: column;
                gap: 10px;
            }
            
            .btn {
                width: 100%;
            }
            
            .stats {
                flex-wrap: wrap;
                gap: 10px;
            }
        }
        
        .loading {
            text-align: center;
            padding: 50px;
            color: #666;
            font-size: 18px;
        }
        
        .loading-spinner {
            display: inline-block;
            width: 50px;
            height: 50px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .chapter-0-info {
            background-color: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-size: 14px;
            color: #856404;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ“š é©¬å…‹æ€é¢˜åº“ç»ƒä¹ é¢˜</h1>
            <p class="subtitle">åŸºäºæ•™æç« èŠ‚åˆ†ç±»ï¼Œç­”é”™ç«‹å³æ˜¾ç¤ºæ­£ç¡®ç­”æ¡ˆ</p>
        </header>
        
        <div class="chapter-filter">
            <span class="filter-label">æŒ‰ç« èŠ‚ç­›é€‰ï¼š</span>
            <select id="chapterFilter" class="filter-select">
                <option value="all">åŠ è½½ä¸­...</option>
            </select>
        </div>
        
        <div class="stats">
            <div class="stat-item">
                <div class="stat-label">å½“å‰è¿›åº¦</div>
                <div class="stat-value" id="progressText">0/0</div>
            </div>
            <div class="stat-item">
                <div class="stat-label">æ­£ç¡®ç‡</div>
                <div class="stat-value" id="accuracyText">0%</div>
            </div>
            <div class="stat-item">
                <div class="stat-label">å·²ç­”é¢˜æ•°</div>
                <div class="stat-value" id="answeredText">0/0</div>
            </div>
        </div>
        
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>
        
        <div class="question-container">
            <div class="loading">
                <div class="loading-spinner"></div>
                <div>æ­£åœ¨åŠ è½½é¢˜åº“ï¼Œè¯·ç¨å€™...</div>
            </div>
            <div class="question-header" style="display: none;">
                <div class="question-number" id="questionNumber">é¢˜ç›® #1</div>
                <div class="question-type" id="questionType">å•é€‰é¢˜</div>
            </div>
            
            <div class="question-text" id="questionText">
                é¢˜ç›®åŠ è½½ä¸­...
            </div>
            
            <div class="options-container" id="optionsContainer">
                <!-- é€‰é¡¹å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
        
        <div class="controls">
            <button class="btn btn-prev" id="prevBtn" disabled>ä¸Šä¸€é¢˜</button>
            <button class="btn btn-next" id="nextBtn" disabled>ä¸‹ä¸€é¢˜</button>
            <button class="btn btn-submit" id="submitBtn" disabled>æäº¤ç­”æ¡ˆ</button>
        </div>
    </div>
    
    <div class="result-modal" id="resultModal">
        <div class="result-content">
            <h2 class="result-title" id="resultTitle">å›ç­”é”™è¯¯</h2>
            <p class="result-message" id="resultMessage">æ­£ç¡®ç­”æ¡ˆæ˜¯ï¼š</p>
            <div class="correct-answer" id="correctAnswer"></div>
            <button class="btn btn-close" id="closeBtn">ç»§ç»­ç­”é¢˜</button>
        </div>
    </div>

    <script>
        // å…¨å±€å˜é‡
        let questionBank = [];
        let filteredQuestions = [];
        let currentQuestionIndex = 0;
        let selectedOption = null;
        let userAnswers = [];
        let correctCount = 0;

        // DOMå…ƒç´ 
        const questionNumberEl = document.getElementById('questionNumber');
        const questionTypeEl = document.getElementById('questionType');
        const questionTextEl = document.getElementById('questionText');
        const optionsContainerEl = document.getElementById('optionsContainer');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const submitBtn = document.getElementById('submitBtn');
        const progressTextEl = document.getElementById('progressText');
        const accuracyTextEl = document.getElementById('accuracyText');
        const answeredTextEl = document.getElementById('answeredText');
        const progressFillEl = document.getElementById('progressFill');
        const chapterFilterEl = document.getElementById('chapterFilter');
        const resultModal = document.getElementById('resultModal');
        const resultTitleEl = document.getElementById('resultTitle');
        const resultMessageEl = document.getElementById('resultMessage');
        const correctAnswerEl = document.getElementById('correctAnswer');
        const closeBtn = document.getElementById('closeBtn');
        const loadingEl = document.querySelector('.loading');
        const questionHeaderEl = document.querySelector('.question-header');

        // åˆå§‹åŒ–
        function init() {
            // åˆå§‹åŒ–ç« èŠ‚ç­›é€‰å™¨
            updateChapterFilterOptions();
            loadQuestion(currentQuestionIndex);
            updateStats();
            
            // äº‹ä»¶ç›‘å¬
            prevBtn.addEventListener('click', goToPrevQuestion);
            nextBtn.addEventListener('click', goToNextQuestion);
            submitBtn.addEventListener('click', submitAnswer);
            chapterFilterEl.addEventListener('change', filterQuestions);
            closeBtn.addEventListener('click', closeModal);
        }

        // æ›´æ–°ç« èŠ‚ç­›é€‰å™¨é€‰é¡¹
        function updateChapterFilterOptions() {
            // æ¸…ç©ºç°æœ‰é€‰é¡¹
            chapterFilterEl.innerHTML = '';
            
            // æ·»åŠ "å…¨éƒ¨é¢˜ç›®"é€‰é¡¹
            const allOption = document.createElement('option');
            allOption.value = "all";
            allOption.textContent = `å…¨éƒ¨é¢˜ç›® (${questionBank.length}é¢˜)`;
            chapterFilterEl.appendChild(allOption);
            
            // è·å–æ‰€æœ‰ç« èŠ‚å¹¶æ’åº
            const chapters = [...new Set(questionBank.map(q => q.chapter))]
                .sort((a, b) => a - b);
            
            // æ·»åŠ ç« èŠ‚é€‰é¡¹
            chapters.forEach(chapter => {
                const option = document.createElement('option');
                option.value = chapter;
                
                // æ ¹æ®ç« èŠ‚å·æ˜¾ç¤ºå¯¹åº”çš„ç« èŠ‚åç§°
                let chapterName = '';
                switch(chapter) {
                    case 0:
                        chapterName = 'æœªåˆ†ç±»é¢˜ç›®';
                        break;
                    case 1:
                        chapterName = 'ç¬¬1ç«  ç»ªè®º';
                        break;
                    case 2:
                        chapterName = 'ç¬¬2ç«  ä¸–ç•Œçš„ç‰©è´¨æ€§åŠå‘å±•è§„å¾‹';
                        break;
                    case 3:
                        chapterName = 'ç¬¬3ç«  å®è·µä¸è®¤è¯†åŠå…¶å‘å±•è§„å¾‹';
                        break;
                    case 4:
                        chapterName = 'ç¬¬4ç«  äººç±»ç¤¾ä¼šåŠå…¶å‘å±•è§„å¾‹';
                        break;
                    case 5:
                        chapterName = 'ç¬¬5ç«  èµ„æœ¬ä¸»ä¹‰çš„æœ¬è´¨åŠè§„å¾‹';
                        break;
                    case 6:
                        chapterName = 'ç¬¬6ç«  èµ„æœ¬ä¸»ä¹‰çš„å‘å±•åŠå…¶è¶‹åŠ¿';
                        break;
                    case 7:
                        chapterName = 'ç¬¬7ç«  ç¤¾ä¼šä¸»ä¹‰çš„å‘å±•åŠå…¶è§„å¾‹';
                        break;
                    case 8:
                        chapterName = 'ç¬¬8ç«  å…±äº§ä¸»ä¹‰å´‡é«˜ç†æƒ³åŠå…¶æœ€ç»ˆå®ç°';
                        break;
                    default:
                        chapterName = `ç¬¬${chapter}ç« `;
                }
                
                // è®¡ç®—è¯¥ç« èŠ‚çš„é¢˜ç›®æ•°é‡
                const chapterQuestions = questionBank.filter(q => q.chapter === chapter);
                option.textContent = `${chapterName} (${chapterQuestions.length}é¢˜)`;
                chapterFilterEl.appendChild(option);
            });
        }

        // åŠ è½½é¢˜ç›®
        function loadQuestion(index) {
            // éšè—åŠ è½½åŠ¨ç”»ï¼Œæ˜¾ç¤ºé¢˜ç›®åŒºåŸŸ
            if (loadingEl) loadingEl.style.display = 'none';
            if (questionHeaderEl) questionHeaderEl.style.display = 'flex';
            
            if (filteredQuestions.length === 0) {
                questionTextEl.textContent = "è¯¥ç« èŠ‚æš‚æ— é¢˜ç›®";
                optionsContainerEl.innerHTML = "";
                questionNumberEl.textContent = "æ— é¢˜ç›®";
                questionTypeEl.textContent = "";
                return;
            }
            
            const question = filteredQuestions[index];
            questionNumberEl.textContent = `é¢˜ç›® #${index + 1}`;
            questionTypeEl.textContent = question.type;
            questionTextEl.textContent = question.question;
            
            // æ¸…ç©ºé€‰é¡¹å®¹å™¨
            optionsContainerEl.innerHTML = "";
            
            // æ·»åŠ ç« èŠ‚0çš„æç¤ºä¿¡æ¯
            if (question.chapter === 0) {
                const chapterInfo = document.createElement('div');
                chapterInfo.className = 'chapter-0-info';
                chapterInfo.textContent = 'æ³¨æ„ï¼šæ­¤é¢˜å°šæœªæŒ‰ç« èŠ‚åˆ†ç±»';
                optionsContainerEl.appendChild(chapterInfo);
            }
            
            // æ·»åŠ é€‰é¡¹
            question.options.forEach((option, i) => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'option';
                
                const letter = String.fromCharCode(65 + i); // A, B, C, D
                if (userAnswers[question.id - 1] === letter) {
                    optionDiv.classList.add('selected');
                }
                
                optionDiv.innerHTML = `
                    <span class="option-letter">${letter}</span>
                    <span class="option-text">${option}</span>
                `;
                
                optionDiv.addEventListener('click', () => selectOption(letter, optionDiv));
                optionsContainerEl.appendChild(optionDiv);
            });
            
            // æ£€æŸ¥æ˜¯å¦æœ‰ç­”æ¡ˆ
            if (!question.answer) {
                const noAnswerInfo = document.createElement('div');
                noAnswerInfo.className = 'chapter-0-info';
                noAnswerInfo.textContent = 'æ³¨æ„ï¼šæ­¤é¢˜æš‚æ— æ­£ç¡®ç­”æ¡ˆä¿¡æ¯';
                optionsContainerEl.appendChild(noAnswerInfo);
            }
            
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            prevBtn.disabled = index === 0;
            nextBtn.disabled = index === filteredQuestions.length - 1;
            submitBtn.disabled = !question.answer; // å¦‚æœæ²¡ç­”æ¡ˆå°±ç¦ç”¨æäº¤æŒ‰é’®
            
            // æ›´æ–°è¿›åº¦æ–‡æœ¬
            progressTextEl.textContent = `${index + 1}/${filteredQuestions.length}`;
            progressFillEl.style.width = `${((index + 1) / filteredQuestions.length) * 100}%`;
            
            // é‡ç½®å½“å‰é€‰æ‹©
            selectedOption = userAnswers[question.id - 1];
        }

        // é€‰æ‹©é€‰é¡¹
        function selectOption(letter, element) {
            // ç§»é™¤ä¹‹å‰çš„é€‰æ‹©
            document.querySelectorAll('.option').forEach(opt => {
                opt.classList.remove('selected');
            });
            
            // æ ‡è®°å½“å‰é€‰æ‹©
            element.classList.add('selected');
            selectedOption = letter;
        }

        // æäº¤ç­”æ¡ˆ
        function submitAnswer() {
            if (filteredQuestions.length === 0) {
                alert("è¯¥ç« èŠ‚æ²¡æœ‰é¢˜ç›®ï¼");
                return;
            }
            
            if (!selectedOption) {
                alert("è¯·å…ˆé€‰æ‹©ä¸€ä¸ªç­”æ¡ˆï¼");
                return;
            }
            
            const currentQuestion = filteredQuestions[currentQuestionIndex];
            const questionId = currentQuestion.id;
            const correctAnswer = currentQuestion.answer;
            
            // æ£€æŸ¥æ˜¯å¦æœ‰ç­”æ¡ˆ
            if (!correctAnswer) {
                alert("æ­¤é¢˜æš‚æ— æ­£ç¡®ç­”æ¡ˆä¿¡æ¯ï¼Œæ— æ³•æäº¤ï¼");
                return;
            }
            
            // ä¿å­˜ç”¨æˆ·ç­”æ¡ˆ
            userAnswers[questionId - 1] = selectedOption;
            
            // æ£€æŸ¥æ˜¯å¦æ­£ç¡®
            const isCorrect = selectedOption === correctAnswer;
            
            if (isCorrect) {
                correctCount++;
                showResult(true, currentQuestion);
            } else {
                showResult(false, currentQuestion);
            }
            
            // æ›´æ–°ç»Ÿè®¡
            updateStats();
            
            // é‡ç½®é€‰æ‹©
            selectedOption = null;
        }

        // æ˜¾ç¤ºç»“æœæ¨¡æ€æ¡†
        function showResult(isCorrect, question) {
            resultTitleEl.textContent = isCorrect ? "å›ç­”æ­£ç¡®ï¼" : "å›ç­”é”™è¯¯";
            resultMessageEl.textContent = isCorrect 
                ? "æ­å–œä½ ï¼Œç­”æ¡ˆæ­£ç¡®ï¼" 
                : "æ­£ç¡®ç­”æ¡ˆæ˜¯ï¼š";
            
            // æ˜¾ç¤ºæ­£ç¡®ç­”æ¡ˆå’Œè§£é‡Š
            const correctOption = question.options.find(opt => 
                opt.startsWith(question.answer + ".")
            );
            
            let explanationHTML = '';
            if (correctOption) {
                explanationHTML = `<strong>${question.answer}. ${correctOption.substring(3)}</strong>`;
            } else {
                explanationHTML = `<strong>${question.answer}</strong>`;
            }
            
            if (question.explanation) {
                explanationHTML += `<br><div style="margin-top: 10px; font-size: 14px; color: #555;">
                    ${question.explanation}
                </div>`;
            } else {
                explanationHTML += `<br><div style="margin-top: 10px; font-size: 14px; color: #555;">
                    æ­¤é¢˜æš‚æ— è¯¦ç»†è§£é‡Š
                </div>`;
            }
            
            correctAnswerEl.innerHTML = explanationHTML;
            
            // æ˜¾ç¤ºæ¨¡æ€æ¡†
            resultModal.style.display = "flex";
            
            // æ ‡è®°å·²ç­”é¢˜ç›®
            const answeredCount = userAnswers.filter(answer => answer !== null).length;
            answeredTextEl.textContent = `${answeredCount}/${questionBank.length}`;
        }

        // å…³é—­æ¨¡æ€æ¡†
        function closeModal() {
            resultModal.style.display = "none";
            
            // è‡ªåŠ¨è·³åˆ°ä¸‹ä¸€é¢˜ï¼ˆå¦‚æœä¸æ˜¯æœ€åä¸€é¢˜ï¼‰
            if (currentQuestionIndex < filteredQuestions.length - 1) {
                goToNextQuestion();
            }
        }

        // ä¸Šä¸€é¢˜
        function goToPrevQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                loadQuestion(currentQuestionIndex);
            }
        }

        // ä¸‹ä¸€é¢˜
        function goToNextQuestion() {
            if (currentQuestionIndex < filteredQuestions.length - 1) {
                currentQuestionIndex++;
                loadQuestion(currentQuestionIndex);
            }
        }

        // ç­›é€‰é¢˜ç›®
        function filterQuestions() {
            const selectedChapter = chapterFilterEl.value;
            
            if (selectedChapter === "all") {
                filteredQuestions = [...questionBank];
            } else {
                filteredQuestions = questionBank.filter(
                    q => q.chapter === parseInt(selectedChapter)
                );
            }
            
            currentQuestionIndex = 0;
            loadQuestion(currentQuestionIndex);
            updateStats();
        }

        // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
        function updateStats() {
            const answeredCount = userAnswers.filter(answer => answer !== null).length;
            const totalQuestions = questionBank.length;
            
            // è®¡ç®—æ­£ç¡®ç‡
            const accuracy = totalQuestions > 0 ? 
                Math.round((correctCount / totalQuestions) * 100) : 0;
            
            // æ›´æ–°æ˜¾ç¤º
            answeredTextEl.textContent = `${answeredCount}/${totalQuestions}`;
            accuracyTextEl.textContent = `${accuracy}%`;
            
            // æ›´æ–°è¿›åº¦æ¡
            const progress = filteredQuestions.length > 0 ? 
                ((currentQuestionIndex + 1) / filteredQuestions.length) * 100 : 0;
            progressFillEl.style.width = `${progress}%`;
            
            // æ›´æ–°è¿›åº¦æ–‡æœ¬
            progressTextEl.textContent = filteredQuestions.length > 0 ? 
                `${currentQuestionIndex + 1}/${filteredQuestions.length}` : 
                "0/0";
        }

        // å¤„ç†é¢˜ç›®æ•°æ®ä¸­çš„ç­”æ¡ˆ
        function extractAnswerFromQuestion(question) {
            // å°è¯•ä»é¢˜ç›®æ–‡æœ¬ä¸­æå–ç­”æ¡ˆ
            const questionText = question.question;
            
            // æ£€æŸ¥é¢˜ç›®æ–‡æœ¬ä¸­æ˜¯å¦åŒ…å«åƒ "ï¼ˆ    A   ï¼‰" è¿™æ ·çš„ç­”æ¡ˆæç¤º
            const answerPattern = /ï¼ˆ\s*([A-D])\s*ï¼‰/g;
            const matches = answerPattern.exec(questionText);
            
            if (matches && matches[1]) {
                return matches[1];
            }
            
            // å¦‚æœé¢˜ç›®æ–‡æœ¬æ²¡æœ‰ç­”æ¡ˆæç¤ºï¼Œå°è¯•ä»é€‰é¡¹ä¸­æ‰¾
            // æ£€æŸ¥æ˜¯å¦æœ‰é€‰é¡¹åŒ…å«äº†ç­”æ¡ˆæç¤º
            for (let i = 0; i < question.options.length; i++) {
                const option = question.options[i];
                const letter = String.fromCharCode(65 + i);
                
                // å¦‚æœé€‰é¡¹æ–‡æœ¬ä¸­æœ‰åƒ "(   A   )" è¿™æ ·çš„æ ‡è®°
                if (option.includes(`(${letter})`) || option.includes(`ï¼ˆ${letter}ï¼‰`)) {
                    return letter;
                }
            }
            
            // å¦‚æœæ²¡æœ‰æ‰¾åˆ°ç­”æ¡ˆï¼Œè¿”å›ç©ºå­—ç¬¦ä¸²
            return "";
        }

        // åŠ è½½JSONé¢˜åº“
        document.addEventListener('DOMContentLoaded', function() {
            console.log('å¼€å§‹åŠ è½½é¢˜åº“...');
            fetch('question_bank.json')
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTPé”™è¯¯! çŠ¶æ€: ${response.status}`);
                    }
                    return response.json();
                })
                .then(data => {
                    console.log('é¢˜åº“åŠ è½½æˆåŠŸ');
                    
                    // ä»å¯¹è±¡ä¸­æå–questionBankæ•°ç»„
                    questionBank = data.questionBank || [];
                    
                    if (!Array.isArray(questionBank) || questionBank.length === 0) {
                        console.error('é¢˜åº“ä¸ºç©ºæˆ–æ ¼å¼ä¸æ­£ç¡®');
                        questionTextEl.textContent = "é¢˜åº“åŠ è½½å¤±è´¥ï¼šé¢˜åº“ä¸ºç©ºæˆ–æ ¼å¼ä¸æ­£ç¡®";
                        return;
                    }
                    
                    console.log('é¢˜ç›®æ•°é‡ï¼š', questionBank.length);
                    console.log('ç¤ºä¾‹é¢˜ç›®ï¼š', questionBank[0]);
                    
                    // é¢„å¤„ç†é¢˜ç›®ï¼šæå–ç­”æ¡ˆ
                    questionBank = questionBank.map(question => {
                        // å¦‚æœç­”æ¡ˆä¸ºç©ºï¼Œå°è¯•ä»é¢˜ç›®ä¸­æå–
                        if (!question.answer) {
                            question.answer = extractAnswerFromQuestion(question);
                        }
                        return question;
                    });
                    
                    // ç»Ÿè®¡æœ‰ç­”æ¡ˆçš„é¢˜ç›®æ•°é‡
                    const questionsWithAnswer = questionBank.filter(q => q.answer).length;
                    console.log(`æœ‰ç­”æ¡ˆçš„é¢˜ç›®æ•°é‡ï¼š${questionsWithAnswer}/${questionBank.length}`);
                    
                    // åˆå§‹åŒ–åº”ç”¨çŠ¶æ€
                    filteredQuestions = [...questionBank];
                    userAnswers = new Array(questionBank.length).fill(null);
                    correctCount = 0;
                    currentQuestionIndex = 0;
                    selectedOption = null;
                    
                    // åˆå§‹åŒ–åº”ç”¨
                    init();
                    
                    // æ˜¾ç¤ºåŠ è½½å®Œæˆçš„æç¤º
                    if (questionsWithAnswer < questionBank.length) {
                        setTimeout(() => {
                            alert(`é¢˜åº“åŠ è½½å®Œæˆï¼\næ€»é¢˜ç›®æ•°ï¼š${questionBank.length}\næœ‰ç­”æ¡ˆé¢˜ç›®ï¼š${questionsWithAnswer}\næ— ç­”æ¡ˆé¢˜ç›®ï¼š${questionBank.length - questionsWithAnswer}\n\næ³¨æ„ï¼šéƒ¨åˆ†é¢˜ç›®ç¼ºå°‘ç­”æ¡ˆï¼Œè¿™äº›é¢˜ç›®å°†æ— æ³•æäº¤ã€‚`);
                        }, 500);
                    }
                })
                .catch(error => {
                    console.error('é¢˜åº“åŠ è½½å¤±è´¥:', error);
                    questionTextEl.textContent = `é¢˜åº“åŠ è½½å¤±è´¥: ${error.message}`;
                    alert(`é¢˜åº“åŠ è½½å¤±è´¥: ${error.message}\nè¯·ç¡®ä¿question_bank.jsonæ–‡ä»¶å­˜åœ¨å¹¶ä¸æœ¬é¡µé¢åœ¨åŒä¸€ç›®å½•`);
                });
        });
    </script>
</body>
</html>